<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>

        <record id="avoid_duplicated_sections" model="base.automation">
            <field name="name">=>Avoid duplicated sections</field>
            <field name="model_id" ref="sale.model_sale_order_line"/>
            <field name="state">code</field>
            <field name="code">
if (record.display_type == 'line_section') and (record.name[:1] == '$'):
  seccion = record.name.split()[0]
  lineas = env['sale.order.line'].search([('order_id','=',record.order_id.id),('display_type','=','line_section'),('section','!=',False),('id','!=',record.id)])
  for li in lineas:
    if seccion == li.section: raise Warning('Nombre de secci√≥n duplicado !!!')
            </field>
            <field name="trigger">on_create_or_write</field>
            <!--<field name="on_change_fields">state</field>-->
            <field name="filter_pre_domain">[('display_type','=','line_section')]</field>
            <field name="filter_domain">[('display_type','=','line_section')]</field>
            <field name="active" eval="True"/>
        </record>

        <record id="sol_multisection_calculate" model="base.automation">
            <field name="name">=>SOL Multisection</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="state">code</field>
            <field name="code">
hay_secciones = env['sale.order.line'].search([('order_id','=',record.id),('display_type','=','line_section')])
if hay_secciones:
  seccion = 0
  for li in record.order_line:
    if (li.display_type == 'line_section') and (record.name):
      seccion_id = li.id
      seccion = str(record.sequence)
      if (record.name[:1] == '$'):
        seccion = record.name.split()[0]
      record['section'] = seccion
    elif (li.display_type != 'line_section') and (seccion > 0):
      li['section_id'] = seccion_id
            </field>
            <field name="trigger">on_create_or_write</field>
            <!--<field name="on_change_fields">state</field>-->
            <field name="filter_pre_domain">[('state','=','draft')]</field>
            <field name="filter_domain">[('state','=','draft')]</field>
            <field name="active" eval="True"/>
        </record>


    </data>

</odoo>